# ä¹ æƒ¯æ¨¡å—éœ€æ±‚æ–‡æ¡£ä¸å®ç°æ–¹æ¡ˆ

## 1. äº§å“æ¦‚è¿°

åŸºäºã€Šä¹ æƒ¯çš„åŠ›é‡ã€‹ä¸€ä¹¦çš„æ ¸å¿ƒç†è®ºï¼Œå®ç°ä¸€ä¸ªå¸®åŠ©ç”¨æˆ·å»ºç«‹å’Œè¿½è¸ªä¹ æƒ¯çš„æ¨¡å—ã€‚è¯¥æ¨¡å—å¼ºè°ƒä¹ æƒ¯å¾ªç¯çš„ä¸‰è¦ç´ ï¼ˆæš—ç¤º-æƒ¯å¸¸è¡Œä¸º-å¥–èµï¼‰ï¼Œå¹¶æ”¯æŒä¹ æƒ¯æ›¿ä»£åŠŸèƒ½ï¼Œå¸®åŠ©ç”¨æˆ·æ”¹å˜ä¸è‰¯ä¹ æƒ¯ã€‚

### 1.1 æ ¸å¿ƒç†è®º

**ç¼–è¾‘ä¹ æƒ¯**
- ä¿®æ”¹ä¹ æƒ¯çš„ä»»æ„å­—æ®µ
- æ›´æ–°æ‰§è¡Œè®°å½•ä¸å—å½±å“

**åˆ é™¤ä¹ æƒ¯**
- è½¯åˆ é™¤ï¼ˆä¿ç•™å†å²æ•°æ®ï¼‰
- å¯æ¢å¤å·²åˆ é™¤çš„ä¹ æƒ¯

**æŸ¥çœ‹ä¹ æƒ¯åˆ—è¡¨**
- æ˜¾ç¤ºæ‰€æœ‰æ´»è·ƒä¹ æƒ¯
- æŒ‰åˆ†ç±»ç­›é€‰
- æŒ‰åˆ›å»ºæ—¶é—´/æœ€åæ‰§è¡Œæ—¶é—´æ’åº
- å¿«é€ŸæŸ¥çœ‹ä¹ æƒ¯å®ŒæˆçŠ¶æ€

#### 2.1.2 ä¹ æƒ¯æ‰§è¡Œä¸è¿½è¸ª

**æ‰“å¡è®°å½•**
- è®°å½•ä¹ æƒ¯æ‰§è¡Œæ—¶é—´
- è®°å½•æ‰§è¡Œè´¨é‡ï¼ˆå¯é€‰ï¼‰
- æ·»åŠ æ‰§è¡Œç¬”è®°ï¼ˆå¯é€‰ï¼‰
- æ”¯æŒè¡¥æ‰“å¡ï¼ˆè¿‡å»æ—¥æœŸï¼‰

**æ‰§è¡Œç»Ÿè®¡**
- è¿ç»­æ‰§è¡Œå¤©æ•°ï¼ˆStreakï¼‰
- æ€»æ‰§è¡Œæ¬¡æ•°
- æœ¬å‘¨/æœ¬æœˆæ‰§è¡Œæ¬¡æ•°
- å®Œæˆç‡åˆ†æ
- æœ€ä½³æ‰§è¡Œæ—¶é—´æ®µ

**å¯è§†åŒ–å±•ç¤º**
- æ—¥å†çƒ­åŠ›å›¾ï¼ˆç±»ä¼¼GitHubè´¡çŒ®å›¾ï¼‰
- è¶‹åŠ¿æŠ˜çº¿å›¾
- ä¹ æƒ¯å®Œæˆç‡é¥¼å›¾

#### 2.1.3 æ¬¡æ—¥è®¡åˆ’ç”Ÿæˆ

**è‡ªåŠ¨ç”ŸæˆåŠŸèƒ½**
- é€‰æ‹©è¦è®¡åˆ’çš„ä¹ æƒ¯
- è‡ªåŠ¨å°†ä¹ æƒ¯çš„"æš—ç¤º"è½¬æ¢ä¸ºå¾…åŠäº‹é¡¹
- ç”Ÿæˆå®Œæ•´çš„æ¬¡æ—¥è®¡åˆ’æ¸…å•
- æŒ‰ä¼˜å…ˆçº§æ’åº

**è®¡åˆ’ç®¡ç†**
- æŸ¥çœ‹æ¬¡æ—¥è®¡åˆ’
- è°ƒæ•´è®¡åˆ’é¡ºåº
- æ ‡è®°è®¡åˆ’å®Œæˆ
- è®¡åˆ’å®Œæˆåè‡ªåŠ¨å…³è”åˆ°ä¹ æƒ¯æ‰“å¡

**ç¤ºä¾‹æµç¨‹**ï¼š
```
ç”¨æˆ·é€‰æ‹©ä¹ æƒ¯ï¼š
1. å»å›¾ä¹¦é¦†å­¦ä¹ 
2. å·è…¹è¿åŠ¨

ç”Ÿæˆæ¬¡æ—¥è®¡åˆ’ï¼š
â–¡ å‡†å¤‡å¥½ä¹¦åŒ…æ”¾åœ¨ä¸€è¿›é—¨å°±èƒ½çœ‹åˆ°çš„æ¤…å­ä¸Šï¼ˆ7:00 AMï¼‰
â–¡ å‡ºé—¨å‰å°†ç‘œä¼½å«é“ºåœ¨åœ°ä¸Šï¼ˆ8:00 PMï¼‰

å®Œæˆæš—ç¤ºå‡†å¤‡åï¼š
â†’ è‡ªåŠ¨è§¦å‘æƒ¯å¸¸è¡Œä¸ºæé†’
â†’ æ‰§è¡Œè¡Œä¸ºåæ‰“å¡
â†’ è®°å½•å¥–èµä½“éªŒ
```

#### 2.1.4 Frontmatterï¼ˆä¹ æƒ¯æ„Ÿæ‚Ÿï¼‰

**åŠŸèƒ½è¯´æ˜**
- ç±»ä¼¼Markdownçš„frontmatterï¼Œè®°å½•ä¹ æƒ¯å¸¦æ¥çš„é•¿æœŸæ„Ÿæ‚Ÿ
- è®°å½•ä¹ æƒ¯çš„å¼ºå¤§åŠ›é‡å’Œä¸ªäººä½“ä¼š
- è¿½è¸ªä¹ æƒ¯å¦‚ä½•æ¸—é€åˆ°ç”Ÿæ´»ä¸­
- è®°å½•ä¸è‡ªè§‰æ‰§è¡Œä¹ æƒ¯çš„æ—¶åˆ»

**å†…å®¹ç»“æ„**
```yaml
---
title: ä¹ æƒ¯çš„åŠ›é‡
created: 2024-01-01
updated: 2024-10-04
tags: [è‡ªå¾‹, æˆé•¿, ä¹ æƒ¯å…»æˆ]
---

# æˆ‘çš„ä¹ æƒ¯æ„Ÿæ‚Ÿ

ä¹ æƒ¯å…·æœ‰å¼ºå¤§çš„ä¸»å¯¼åŠ›ï¼Œä¸å¯æŠµæŠ—çš„åŠ›é‡ã€‚å…»æˆè€ƒè™‘é¡ºåºçš„ä¹ æƒ¯ã€‚

## å·²å†…åŒ–çš„ä¹ æƒ¯

è¿™äº›ä¹ æƒ¯å·²ç»æ¸—é€åˆ°æˆ‘çš„ç”Ÿæ´»ï¼Œå¹¶ä¸”è¢«æˆ‘ä¸è‡ªè§‰åœ°æ‰§è¡Œï¼š

1. **å»å›¾ä¹¦é¦†çš„ä¹ æƒ¯**
   - å³ä½¿ä¸‹é›¨ã€å³ä½¿ä¾¿ç§˜10ç‚¹ä¹Ÿè¦åšæŒ
   - å·²ç»æˆä¸ºæˆ‘çš„ä¸€éƒ¨åˆ†

2. **å‘¨æœ«å­¦ä¹ ä¹ æƒ¯**
   - å…»æˆäº†å‘¨æœ«ä¸Šåˆã€æ™šä¸Šå»å›¾ä¹¦é¦†çš„ä¹ æƒ¯
   - å³ä½¿20:30ä¹Ÿä¼šå»

3. **å·è…¹ä¹ æƒ¯**
   - ä¸çŸ¥ä¸è§‰é—´å·²ç»å…»æˆ

## ä¹ æƒ¯å¸¦æ¥çš„æ”¹å˜

- è‡ªå¾‹çš„å®ç°è®©æˆ‘ç²¾ç¥æ»¡è¶³
- å¯¹è‡ªå·±çš„æŒæ§åŠ›æ˜¾è‘—æå‡
- è…¹è‚Œå¸¦æ¥çš„è‡ªä¿¡ï¼Œå®ƒæ˜¯æˆ‘åšæŒçš„è§è¯
```

**ç¼–è¾‘åŠŸèƒ½**
- Markdownç¼–è¾‘å™¨
- æ”¯æŒæ ‡ç­¾ç®¡ç†
- æ—¶é—´çº¿å±•ç¤ºæ„Ÿæ‚Ÿå˜åŒ–
- ä¸ä¹ æƒ¯å…³è”æ˜¾ç¤º

---

## 3. æ•°æ®æ¨¡å‹è®¾è®¡

### 3.1 æ•°æ®åº“è¡¨ç»“æ„

#### 3.1.1 Habitsï¼ˆä¹ æƒ¯è¡¨ï¼‰

```dart
class Habit {
  final String id;              // UUID
  final String name;            // ä¹ æƒ¯åç§°
  final String cue;             // æš—ç¤º
  final String routine;         // æƒ¯å¸¸è¡Œä¸º
  final String? oldRoutine;     // åŸæƒ¯å¸¸è¡Œä¸ºï¼ˆä¹ æƒ¯æ›¿ä»£æ—¶ä½¿ç”¨ï¼‰
  final String reward;          // å¥–èµ
  final HabitType type;         // ç±»å‹ï¼šPOSITIVE æˆ– REPLACEMENT
  final String? category;       // åˆ†ç±»æ ‡ç­¾
  final String? notes;          // å¤‡æ³¨
  final bool isActive;          // æ˜¯å¦æ´»è·ƒ
  final DateTime createdAt;     // åˆ›å»ºæ—¶é—´
  final DateTime updatedAt;     // æ›´æ–°æ—¶é—´
  final DateTime? deletedAt;    // åˆ é™¤æ—¶é—´ï¼ˆè½¯åˆ é™¤ï¼‰
}

enum HabitType {
  POSITIVE,      // æ­£å‘ä¹ æƒ¯
  REPLACEMENT    // ä¹ æƒ¯æ›¿ä»£
}
```

#### 3.1.2 HabitRecordsï¼ˆä¹ æƒ¯æ‰§è¡Œè®°å½•è¡¨ï¼‰

```dart
class HabitRecord {
  final String id;              // UUID
  final String habitId;         // å…³è”çš„ä¹ æƒ¯ID
  final DateTime executedAt;    // æ‰§è¡Œæ—¶é—´
  final int? quality;           // æ‰§è¡Œè´¨é‡ï¼ˆ1-5æ˜Ÿï¼‰
  final String? notes;          // æ‰§è¡Œç¬”è®°
  final bool isBackfilled;      // æ˜¯å¦æ˜¯è¡¥æ‰“å¡
  final DateTime createdAt;     // è®°å½•åˆ›å»ºæ—¶é—´
}
```

#### 3.1.3 DailyPlansï¼ˆæ¬¡æ—¥è®¡åˆ’è¡¨ï¼‰

```dart
class DailyPlan {
  final String id;              // UUID
  final DateTime planDate;      // è®¡åˆ’æ—¥æœŸ
  final String habitId;         // å…³è”çš„ä¹ æƒ¯ID
  final String cueTask;         // æš—ç¤ºä»»åŠ¡ï¼ˆä»ä¹ æƒ¯å¤åˆ¶ï¼‰
  final DateTime? scheduledTime;// è®¡åˆ’æ‰§è¡Œæ—¶é—´
  final int priority;           // ä¼˜å…ˆçº§
  final bool isCompleted;       // æ˜¯å¦å®Œæˆ
  final DateTime? completedAt;  // å®Œæˆæ—¶é—´
  final String? recordId;       // å…³è”çš„æ‰§è¡Œè®°å½•ID
  final DateTime createdAt;     // åˆ›å»ºæ—¶é—´
}
```

#### 3.1.4 HabitFrontmatterï¼ˆä¹ æƒ¯æ„Ÿæ‚Ÿè¡¨ï¼‰

```dart
class HabitFrontmatter {
  final String id;              // UUID
  final String title;           // æ ‡é¢˜
  final String content;         // Markdownå†…å®¹
  final List<String> tags;      // æ ‡ç­¾
  final DateTime createdAt;     // åˆ›å»ºæ—¶é—´
  final DateTime updatedAt;     // æ›´æ–°æ—¶é—´
  final Map<String, dynamic> metadata; // æ‰©å±•å…ƒæ•°æ®
}
```

### 3.2 SQLite DDL

```sql
-- ä¹ æƒ¯è¡¨
CREATE TABLE habits (
  id TEXT PRIMARY KEY,
  name TEXT NOT NULL,
  cue TEXT NOT NULL,
  routine TEXT NOT NULL,
  old_routine TEXT,
  reward TEXT NOT NULL,
  type TEXT NOT NULL CHECK(type IN ('POSITIVE', 'REPLACEMENT')),
  category TEXT,
  notes TEXT,
  is_active INTEGER NOT NULL DEFAULT 1,
  created_at INTEGER NOT NULL,
  updated_at INTEGER NOT NULL,
  deleted_at INTEGER
);

CREATE INDEX idx_habits_is_active ON habits(is_active);
CREATE INDEX idx_habits_type ON habits(type);
CREATE INDEX idx_habits_category ON habits(category);

-- æ‰§è¡Œè®°å½•è¡¨
CREATE TABLE habit_records (
  id TEXT PRIMARY KEY,
  habit_id TEXT NOT NULL,
  executed_at INTEGER NOT NULL,
  quality INTEGER CHECK(quality >= 1 AND quality <= 5),
  notes TEXT,
  is_backfilled INTEGER NOT NULL DEFAULT 0,
  created_at INTEGER NOT NULL,
  FOREIGN KEY (habit_id) REFERENCES habits(id) ON DELETE CASCADE
);

CREATE INDEX idx_records_habit_id ON habit_records(habit_id);
CREATE INDEX idx_records_executed_at ON habit_records(executed_at);

-- æ¬¡æ—¥è®¡åˆ’è¡¨
CREATE TABLE daily_plans (
  id TEXT PRIMARY KEY,
  plan_date INTEGER NOT NULL,
  habit_id TEXT NOT NULL,
  cue_task TEXT NOT NULL,
  scheduled_time INTEGER,
  priority INTEGER NOT NULL DEFAULT 0,
  is_completed INTEGER NOT NULL DEFAULT 0,
  completed_at INTEGER,
  record_id TEXT,
  created_at INTEGER NOT NULL,
  FOREIGN KEY (habit_id) REFERENCES habits(id) ON DELETE CASCADE,
  FOREIGN KEY (record_id) REFERENCES habit_records(id) ON DELETE SET NULL
);

CREATE INDEX idx_plans_date ON daily_plans(plan_date);
CREATE INDEX idx_plans_habit_id ON daily_plans(habit_id);
CREATE INDEX idx_plans_completed ON daily_plans(is_completed);

-- ä¹ æƒ¯æ„Ÿæ‚Ÿè¡¨
CREATE TABLE habit_frontmatters (
  id TEXT PRIMARY KEY,
  title TEXT NOT NULL,
  content TEXT NOT NULL,
  tags TEXT NOT NULL, -- JSONæ•°ç»„
  created_at INTEGER NOT NULL,
  updated_at INTEGER NOT NULL,
  metadata TEXT -- JSONå¯¹è±¡
);

CREATE INDEX idx_frontmatters_created_at ON habit_frontmatters(created_at);
```

---

## 4. UI/UX è®¾è®¡

### 4.1 é¡µé¢ç»“æ„

#### 4.1.1 ä¹ æƒ¯åˆ—è¡¨é¡µï¼ˆä¸»é¡µï¼‰

**å¸ƒå±€ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¹ æƒ¯è¿½è¸ª              [Frontmatter] â”‚
â”‚  [+ æ·»åŠ ä¹ æƒ¯]                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ” æœç´¢  |  ğŸ“ åˆ†ç±»  |  ğŸ¯ çŠ¶æ€     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“š å»å›¾ä¹¦é¦†å­¦ä¹                     â”‚
â”‚  â”œ æš—ç¤º: å‡†å¤‡ä¹¦åŒ…æ”¾æ˜¾çœ¼ä½ç½®        â”‚
â”‚  â”œ è¿ç»­: ğŸ”¥ 15å¤©                    â”‚
â”‚  â”” [âœ“ ä»Šæ—¥æ‰“å¡]          [è¯¦æƒ… >]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’ª å·è…¹è¿åŠ¨                        â”‚
â”‚  â”œ æš—ç¤º: é“ºç‘œä¼½å«åœ¨åœ°ä¸Š            â”‚
â”‚  â”œ è¿ç»­: ğŸ”¥ 7å¤©                     â”‚
â”‚  â”” [âœ“ ä»Šæ—¥æ‰“å¡]          [è¯¦æƒ… >]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ¥¤ å¥åº·é¥®é£Ÿ [æ›¿ä»£]                â”‚
â”‚  â”œ æš—ç¤º: æ— èŠæƒ³åˆºæ¿€                â”‚
â”‚  â”œ è¿ç»­: ğŸ”¥ 3å¤©                     â”‚
â”‚  â”” [ ä»Šæ—¥æ‰“å¡]           [è¯¦æƒ… >]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åŠŸèƒ½ç»„ä»¶ï¼š**
- ä¹ æƒ¯å¡ç‰‡ï¼ˆSwipeActionæ”¯æŒåˆ é™¤/ç¼–è¾‘ï¼‰
- è¿ç»­å¤©æ•°å¾½ç« 
- å¿«é€Ÿæ‰“å¡æŒ‰é’®
- åˆ†ç±»ç­›é€‰å™¨
- æœç´¢æ¡†

#### 4.1.2 ä¹ æƒ¯è¯¦æƒ…é¡µ

**å¸ƒå±€ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  < è¿”å›    å»å›¾ä¹¦é¦†å­¦ä¹       [ç¼–è¾‘] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“‹ ä¹ æƒ¯å¾ªç¯                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ”” æš—ç¤º                       â”‚  â”‚
â”‚  â”‚ å‡†å¤‡å¥½ä¹¦åŒ…æ”¾åœ¨ä¸€è¿›é—¨å°±èƒ½çœ‹    â”‚  â”‚
â”‚  â”‚ åˆ°çš„æ¤…å­æˆ–æ¡Œå­ä¸Š              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸƒ æƒ¯å¸¸è¡Œä¸º                   â”‚  â”‚
â”‚  â”‚ æ‹¿èµ·ä¹¦åŒ…å»å›¾ä¹¦é¦†              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ å¥–èµ                       â”‚  â”‚
â”‚  â”‚ è‡ªå¾‹çš„å®ç°è®©æˆ‘ç²¾ç¥æ»¡è¶³ï¼Œ      â”‚  â”‚
â”‚  â”‚ å¯¹è‡ªå·±çš„æŒæ§åŠ›                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“Š æ‰§è¡Œç»Ÿè®¡                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚è¿ç»­ â”‚æ€»è®¡ â”‚æœ¬å‘¨ â”‚å®Œæˆç‡â”‚         â”‚
â”‚  â”‚15å¤© â”‚45æ¬¡ â”‚5æ¬¡  â”‚90%  â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                     â”‚
â”‚  [æ—¥å†çƒ­åŠ›å›¾]                       â”‚
â”‚  ä¸€ äºŒ ä¸‰ å›› äº” å…­ æ—¥                â”‚
â”‚  â–  â–  â–  â–¡ â–  â–  â–                    â”‚
â”‚  â–  â–  â–  â–  â–¡ â–  â–                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“ æ‰§è¡Œè®°å½•                        â”‚
â”‚  2024-10-04 20:30 â­â­â­â­â­       â”‚
â”‚  å¤‡æ³¨: ä»Šå¤©æ•ˆç‡ç‰¹åˆ«é«˜               â”‚
â”‚                                     â”‚
â”‚  2024-10-03 19:00 â­â­â­â­         â”‚
â”‚  å¤‡æ³¨: ç¨å¾®æœ‰ç‚¹ç´¯ä½†åšæŒäº†           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ä»Šæ—¥æ‰“å¡]       [æŸ¥çœ‹å®Œæ•´è®°å½•]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.1.3 åˆ›å»º/ç¼–è¾‘ä¹ æƒ¯é¡µ

**å¸ƒå±€ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  < è¿”å›      æ·»åŠ ä¹ æƒ¯      [ä¿å­˜]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä¹ æƒ¯åç§°                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ å»å›¾ä¹¦é¦†å­¦ä¹                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                     â”‚
â”‚  ä¹ æƒ¯ç±»å‹                           â”‚
â”‚  â—‹ æ­£å‘ä¹ æƒ¯  â— ä¹ æƒ¯æ›¿ä»£             â”‚
â”‚                                     â”‚
â”‚  ğŸ”” æš—ç¤ºï¼ˆè§¦å‘æ¡ä»¶ï¼‰                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ å‡†å¤‡å¥½ä¹¦åŒ…æ”¾åœ¨ä¸€è¿›é—¨å°±èƒ½çœ‹åˆ°  â”‚  â”‚
â”‚  â”‚ çš„æ¤…å­æˆ–æ¡Œå­ä¸Š                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  ğŸ’¡ æç¤ºï¼šæš—ç¤ºè¶Šå…·ä½“ï¼Œè¶Šå®¹æ˜“è§¦å‘    â”‚
â”‚                                     â”‚
â”‚  [å¦‚æœæ˜¯ä¹ æƒ¯æ›¿ä»£ï¼Œæ˜¾ç¤ºåŸæƒ¯å¸¸è¡Œä¸º]   â”‚
â”‚  âŒ åŸæƒ¯å¸¸è¡Œä¸º                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ï¼ˆé€‰å¡«ï¼‰                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                     â”‚
â”‚  ğŸƒ æƒ¯å¸¸è¡Œä¸ºï¼ˆè¦æ‰§è¡Œçš„åŠ¨ä½œï¼‰        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ æ‹¿èµ·ä¹¦åŒ…å»å›¾ä¹¦é¦†              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                     â”‚
â”‚  ğŸ å¥–èµï¼ˆè¡Œä¸ºå¸¦æ¥çš„æ”¶ç›Šï¼‰          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ è‡ªå¾‹çš„å®ç°è®©æˆ‘ç²¾ç¥æ»¡è¶³ï¼Œ      â”‚  â”‚
â”‚  â”‚ å¯¹è‡ªå·±çš„æŒæ§åŠ›                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  ğŸ’¡ æç¤ºï¼šæ˜ç¡®å¥–èµæœ‰åŠ©äºä¹ æƒ¯å…»æˆ    â”‚
â”‚                                     â”‚
â”‚  ğŸ“ åˆ†ç±»æ ‡ç­¾                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ å­¦ä¹  â–¼                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                     â”‚
â”‚  ğŸ“ å¤‡æ³¨                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ï¼ˆé€‰å¡«ï¼‰                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.1.4 æ¬¡æ—¥è®¡åˆ’é¡µ

**å¸ƒå±€ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  < è¿”å›    æ˜æ—¥è®¡åˆ’      [ç”Ÿæˆè®¡åˆ’] â”‚
â”‚  2024å¹´10æœˆ5æ—¥ æ˜ŸæœŸå…­               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä»ä¹ æƒ¯ç”Ÿæˆ â”ƒ æ‰‹åŠ¨æ·»åŠ               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â˜ 7:00 AM                          â”‚
â”‚    å‡†å¤‡å¥½ä¹¦åŒ…æ”¾åœ¨ä¸€è¿›é—¨å°±èƒ½çœ‹åˆ°çš„   â”‚
â”‚    æ¤…å­æˆ–æ¡Œå­ä¸Š                     â”‚
â”‚    â†’ å…³è”: å»å›¾ä¹¦é¦†å­¦ä¹              â”‚
â”‚    [æ ‡è®°å®Œæˆ]                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â˜ 8:00 PM                          â”‚
â”‚    å‡ºé—¨å‰å°†ç‘œä¼½å«é“ºåœ¨åœ°ä¸Š           â”‚
â”‚    â†’ å…³è”: å·è…¹è¿åŠ¨                 â”‚
â”‚    [æ ‡è®°å®Œæˆ]                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â˜‘ 9:00 AM                          â”‚
â”‚    å‡†å¤‡å¥åº·é›¶é£Ÿï¼ˆå·²å®Œæˆï¼‰           â”‚
â”‚    â†’ å…³è”: å¥åº·é¥®é£Ÿ                 â”‚
â”‚    âœ“ å·²å…³è”åˆ°æ‰“å¡è®°å½•               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç”Ÿæˆè®¡åˆ’å¯¹è¯æ¡†ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é€‰æ‹©è¦è®¡åˆ’çš„ä¹ æƒ¯                   â”‚
â”‚                                     â”‚
â”‚  â˜‘ å»å›¾ä¹¦é¦†å­¦ä¹                     â”‚
â”‚    å»ºè®®æ—¶é—´: 7:00 AM                â”‚
â”‚                                     â”‚
â”‚  â˜‘ å·è…¹è¿åŠ¨                        â”‚
â”‚    å»ºè®®æ—¶é—´: 8:00 PM                â”‚
â”‚                                     â”‚
â”‚  â˜ å¥åº·é¥®é£Ÿ                        â”‚
â”‚    å»ºè®®æ—¶é—´: å…¨å¤©                   â”‚
â”‚                                     â”‚
â”‚  [å–æ¶ˆ]              [ç”Ÿæˆè®¡åˆ’]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.1.5 Frontmatterï¼ˆä¹ æƒ¯æ„Ÿæ‚Ÿï¼‰é¡µ

**å¸ƒå±€ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  < è¿”å›    ä¹ æƒ¯æ„Ÿæ‚Ÿ         [ç¼–è¾‘]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ---                                â”‚
â”‚  title: ä¹ æƒ¯çš„åŠ›é‡                  â”‚
â”‚  created: 2024-01-01                â”‚
â”‚  updated: 2024-10-04                â”‚
â”‚  tags: [è‡ªå¾‹, æˆé•¿, ä¹ æƒ¯å…»æˆ]       â”‚
â”‚  ---                                â”‚
â”‚                                     â”‚
â”‚  # æˆ‘çš„ä¹ æƒ¯æ„Ÿæ‚Ÿ                     â”‚
â”‚                                     â”‚
â”‚  ä¹ æƒ¯å…·æœ‰å¼ºå¤§çš„ä¸»å¯¼åŠ›ï¼Œä¸å¯æŠµæŠ—çš„   â”‚
â”‚  åŠ›é‡ã€‚å…»æˆè€ƒè™‘é¡ºåºçš„ä¹ æƒ¯ã€‚         â”‚
â”‚                                     â”‚
â”‚  ## å·²å†…åŒ–çš„ä¹ æƒ¯                    â”‚
â”‚                                     â”‚
â”‚  è¿™äº›ä¹ æƒ¯å·²ç»æ¸—é€åˆ°æˆ‘çš„ç”Ÿæ´»ï¼Œå¹¶ä¸”   â”‚
â”‚  è¢«æˆ‘ä¸è‡ªè§‰åœ°æ‰§è¡Œï¼š                 â”‚
â”‚                                     â”‚
â”‚  1. **å»å›¾ä¹¦é¦†çš„ä¹ æƒ¯**              â”‚
â”‚     - å³ä½¿ä¸‹é›¨ã€å³ä½¿ä¾¿ç§˜10ç‚¹ä¹Ÿè¦åšæŒâ”‚
â”‚     - å·²ç»æˆä¸ºæˆ‘çš„ä¸€éƒ¨åˆ†            â”‚
â”‚                                     â”‚
â”‚  2. **å‘¨æœ«å­¦ä¹ ä¹ æƒ¯**                â”‚
â”‚     - å…»æˆäº†å‘¨æœ«ä¸Šåˆã€æ™šä¸Šå»å›¾ä¹¦é¦†  â”‚
â”‚       çš„ä¹ æƒ¯                        â”‚
â”‚     - å³ä½¿20:30ä¹Ÿä¼šå»               â”‚
â”‚                                     â”‚
â”‚  ## ä¹ æƒ¯å¸¦æ¥çš„æ”¹å˜                  â”‚
â”‚                                     â”‚
â”‚  - è‡ªå¾‹çš„å®ç°è®©æˆ‘ç²¾ç¥æ»¡è¶³           â”‚
â”‚  - å¯¹è‡ªå·±çš„æŒæ§åŠ›æ˜¾è‘—æå‡           â”‚
â”‚  - è…¹è‚Œå¸¦æ¥çš„è‡ªä¿¡ï¼Œå®ƒæ˜¯æˆ‘åšæŒçš„è§è¯â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç¼–è¾‘æ¨¡å¼ï¼š**
- Markdownå®æ—¶é¢„è§ˆ
- æ”¯æŒå¯Œæ–‡æœ¬å·¥å…·æ 
- æ ‡ç­¾é€‰æ‹©å™¨
- è‡ªåŠ¨ä¿å­˜è‰ç¨¿

### 4.2 äº¤äº’è®¾è®¡

#### 4.2.1 æ‰“å¡æµç¨‹

```
ç”¨æˆ·ç‚¹å‡»"ä»Šæ—¥æ‰“å¡" 
    â†“
æ˜¾ç¤ºæ‰“å¡å¯¹è¯æ¡†
    â”œâ”€ æ‰§è¡Œæ—¶é—´ï¼ˆé»˜è®¤å½“å‰ï¼‰
    â”œâ”€ æ‰§è¡Œè´¨é‡ï¼ˆ1-5æ˜Ÿï¼‰
    â””â”€ æ‰§è¡Œç¬”è®°ï¼ˆå¯é€‰ï¼‰
    â†“
ç‚¹å‡»"ç¡®è®¤æ‰“å¡"
    â†“
è®°å½•ä¿å­˜ + åŠ¨ç”»åé¦ˆ
    â”œâ”€ âœ“ å›¾æ ‡æ”¾å¤§åŠ¨ç”»
    â”œâ”€ è¿ç»­å¤©æ•°+1
    â””â”€ æˆå°±é€šçŸ¥ï¼ˆå¦‚è¿ç»­7å¤©ã€30å¤©ç­‰ï¼‰
    â†“
è¿”å›åˆ—è¡¨é¡µï¼Œå¡ç‰‡æ›´æ–°
```

#### 4.2.2 è®¡åˆ’ç”Ÿæˆæµç¨‹

```
ç”¨æˆ·æ‰“å¼€"æ¬¡æ—¥è®¡åˆ’"é¡µ
    â†“
ç‚¹å‡»"ç”Ÿæˆè®¡åˆ’"
    â†“
æ˜¾ç¤ºä¹ æƒ¯é€‰æ‹©å¯¹è¯æ¡†
    â”œâ”€ åˆ—å‡ºæ‰€æœ‰æ´»è·ƒä¹ æƒ¯
    â”œâ”€ é»˜è®¤å…¨é€‰
    â””â”€ å»ºè®®æ‰§è¡Œæ—¶é—´
    â†“
ç”¨æˆ·è°ƒæ•´é€‰æ‹©å’Œæ—¶é—´
    â†“
ç‚¹å‡»"ç”Ÿæˆè®¡åˆ’"
    â†“
ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆè®¡åˆ’åˆ—è¡¨
    â”œâ”€ å°†"æš—ç¤º"ä½œä¸ºä»»åŠ¡
    â”œâ”€ æŒ‰æ—¶é—´æ’åº
    â””â”€ å…³è”å¯¹åº”ä¹ æƒ¯
    â†“
è®¡åˆ’åˆ—è¡¨å±•ç¤º
```

#### 4.2.3 è®¡åˆ’å®Œæˆåˆ°æ‰“å¡æµç¨‹

```
ç”¨æˆ·æ ‡è®°è®¡åˆ’å®Œæˆ
    â†“
ç³»ç»Ÿæ£€æµ‹æ˜¯å¦å…³è”ä¹ æƒ¯
    â†“
å¦‚æœå…³è”ä¹ æƒ¯ï¼Œå¼¹å‡ºç¡®è®¤
    "æš—ç¤ºå·²å®Œæˆï¼Œæ˜¯å¦æ‰§è¡Œæƒ¯å¸¸è¡Œä¸ºå¹¶æ‰“å¡ï¼Ÿ"
    â”œâ”€ æ˜¯ â†’ è·³è½¬åˆ°æ‰“å¡å¯¹è¯æ¡†ï¼ˆé¢„å¡«ä¹ æƒ¯ï¼‰
    â””â”€ å¦ â†’ ä»…æ ‡è®°è®¡åˆ’å®Œæˆ
    â†“
å®Œæˆæ‰“å¡åè‡ªåŠ¨å…³è”
    â”œâ”€ daily_plans.record_id = record.id
    â””â”€ daily_plans.completed_at = now()
```

---

## 5. æŠ€æœ¯å®ç°æ–¹æ¡ˆ

### 5.1 æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: Flutter 3.35.5
- **çŠ¶æ€ç®¡ç†**: Riverpod 2.x
- **æœ¬åœ°æ•°æ®åº“**: Drift (SQLite)
- **è·¯ç”±**: go_router
- **UIé£æ ¼**: Cupertino (iOSé£æ ¼)

### 5.2 é¡¹ç›®ç»“æ„

```
lib/features/habits/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ datasources/
â”‚   â”‚   â””â”€â”€ habit_local_datasource.dart     # æœ¬åœ°æ•°æ®æº
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ habit_model.dart                # ä¹ æƒ¯æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ habit_record_model.dart         # æ‰§è¡Œè®°å½•æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ daily_plan_model.dart           # æ¬¡æ—¥è®¡åˆ’æ¨¡å‹
â”‚   â”‚   â””â”€â”€ habit_frontmatter_model.dart    # Frontmatteræ¨¡å‹
â”‚   â””â”€â”€ repositories/
â”‚       â””â”€â”€ habit_repository_impl.dart      # ä»“åº“å®ç°
â”œâ”€â”€ domain/
â”‚   â”œâ”€â”€ entities/
â”‚   â”‚   â”œâ”€â”€ habit.dart                      # ä¹ æƒ¯å®ä½“
â”‚   â”‚   â”œâ”€â”€ habit_record.dart               # è®°å½•å®ä½“
â”‚   â”‚   â”œâ”€â”€ daily_plan.dart                 # è®¡åˆ’å®ä½“
â”‚   â”‚   â””â”€â”€ habit_frontmatter.dart          # Frontmatterå®ä½“
â”‚   â”œâ”€â”€ repositories/
â”‚   â”‚   â””â”€â”€ habit_repository.dart           # ä»“åº“æ¥å£
â”‚   â””â”€â”€ usecases/
â”‚       â”œâ”€â”€ create_habit.dart               # åˆ›å»ºä¹ æƒ¯ç”¨ä¾‹
â”‚       â”œâ”€â”€ get_habits.dart                 # è·å–ä¹ æƒ¯åˆ—è¡¨
â”‚       â”œâ”€â”€ record_habit_execution.dart     # è®°å½•æ‰§è¡Œ
â”‚       â”œâ”€â”€ generate_daily_plan.dart        # ç”Ÿæˆæ¬¡æ—¥è®¡åˆ’
â”‚       â””â”€â”€ ...                             # å…¶ä»–ç”¨ä¾‹
â”œâ”€â”€ presentation/
â”‚   â”œâ”€â”€ providers/
â”‚   â”‚   â”œâ”€â”€ habit_provider.dart             # ä¹ æƒ¯çŠ¶æ€æä¾›è€…
â”‚   â”‚   â”œâ”€â”€ habit_record_provider.dart      # è®°å½•çŠ¶æ€æä¾›è€…
â”‚   â”‚   â”œâ”€â”€ daily_plan_provider.dart        # è®¡åˆ’çŠ¶æ€æä¾›è€…
â”‚   â”‚   â””â”€â”€ frontmatter_provider.dart       # FrontmatterçŠ¶æ€
â”‚   â”œâ”€â”€ screens/
â”‚   â”‚   â”œâ”€â”€ habits_screen.dart              # ä¹ æƒ¯åˆ—è¡¨é¡µ
â”‚   â”‚   â”œâ”€â”€ habit_detail_screen.dart        # ä¹ æƒ¯è¯¦æƒ…é¡µ
â”‚   â”‚   â”œâ”€â”€ habit_form_screen.dart          # åˆ›å»º/ç¼–è¾‘é¡µ
â”‚   â”‚   â”œâ”€â”€ daily_plan_screen.dart          # æ¬¡æ—¥è®¡åˆ’é¡µ
â”‚   â”‚   â””â”€â”€ frontmatter_screen.dart         # Frontmatteré¡µ
â”‚   â””â”€â”€ widgets/
â”‚       â”œâ”€â”€ habit_card.dart                 # ä¹ æƒ¯å¡ç‰‡
â”‚       â”œâ”€â”€ habit_calendar_heatmap.dart     # æ—¥å†çƒ­åŠ›å›¾
â”‚       â”œâ”€â”€ habit_stats_card.dart           # ç»Ÿè®¡å¡ç‰‡
â”‚       â”œâ”€â”€ check_in_dialog.dart            # æ‰“å¡å¯¹è¯æ¡†
â”‚       â””â”€â”€ plan_generator_dialog.dart      # è®¡åˆ’ç”Ÿæˆå¯¹è¯æ¡†
â””â”€â”€ ...
```

### 5.3 æ ¸å¿ƒä»£ç ç¤ºä¾‹

#### 5.3.1 å®ä½“å®šä¹‰

```dart
// lib/features/habits/domain/entities/habit.dart
import 'package:freezed_annotation/freezed_annotation.dart';

part 'habit.freezed.dart';

@freezed
class Habit with _$Habit {
  const factory Habit({
    required String id,
    required String name,
    required String cue,
    required String routine,
    String? oldRoutine,
    required String reward,
    required HabitType type,
    String? category,
    String? notes,
    required bool isActive,
    required DateTime createdAt,
    required DateTime updatedAt,
    DateTime? deletedAt,
  }) = _Habit;
}

enum HabitType {
  positive,
  replacement,
}
```

```dart
// lib/features/habits/domain/entities/habit_record.dart
@freezed
class HabitRecord with _$HabitRecord {
  const factory HabitRecord({
    required String id,
    required String habitId,
    required DateTime executedAt,
    int? quality,
    String? notes,
    required bool isBackfilled,
    required DateTime createdAt,
  }) = _HabitRecord;
}
```

```dart
// lib/features/habits/domain/entities/daily_plan.dart
@freezed
class DailyPlan with _$DailyPlan {
  const factory DailyPlan({
    required String id,
    required DateTime planDate,
    required String habitId,
    required String cueTask,
    DateTime? scheduledTime,
    required int priority,
    required bool isCompleted,
    DateTime? completedAt,
    String? recordId,
    required DateTime createdAt,
  }) = _DailyPlan;
}
```

#### 5.3.2 Driftæ•°æ®åº“é…ç½®

```dart
// lib/core/database/app_database.dart
import 'package:drift/drift.dart';
import 'package:drift_flutter/drift_flutter.dart';

part 'app_database.g.dart';

@DriftDatabase(
  tables: [Habits, HabitRecords, DailyPlans, HabitFrontmatters],
  daos: [HabitDao, HabitRecordDao, DailyPlanDao, FrontmatterDao],
)
class AppDatabase extends _$AppDatabase {
  AppDatabase() : super(_openConnection());

  @override
  int get schemaVersion => 1;

  static QueryExecutor _openConnection() {
    return driftDatabase(name: 'wudao_db');
  }
}

@DataClassName('HabitData')
class Habits extends Table {
  TextColumn get id => text()();
  TextColumn get name => text()();
  TextColumn get cue => text()();
  TextColumn get routine => text()();
  TextColumn get oldRoutine => text().nullable()();
  TextColumn get reward => text()();
  TextColumn get type => textEnum<HabitType>()();
  TextColumn get category => text().nullable()();
  TextColumn get notes => text().nullable()();
  BoolColumn get isActive => boolean().withDefault(const Constant(true))();
  DateTimeColumn get createdAt => dateTime()();
  DateTimeColumn get updatedAt => dateTime()();
  DateTimeColumn get deletedAt => dateTime().nullable()();

  @override
  Set<Column> get primaryKey => {id};
}

@DataClassName('HabitRecordData')
class HabitRecords extends Table {
  TextColumn get id => text()();
  TextColumn get habitId => text().references(Habits, #id, onDelete: KeyAction.cascade)();
  DateTimeColumn get executedAt => dateTime()();
  IntColumn get quality => integer().nullable()();
  TextColumn get notes => text().nullable()();
  BoolColumn get isBackfilled => boolean().withDefault(const Constant(false))();
  DateTimeColumn get createdAt => dateTime()();

  @override
  Set<Column> get primaryKey => {id};
}

@DataClassName('DailyPlanData')
class DailyPlans extends Table {
  TextColumn get id => text()();
  DateTimeColumn get planDate => dateTime()();
  TextColumn get habitId => text().references(Habits, #id, onDelete: KeyAction.cascade)();
  TextColumn get cueTask => text()();
  DateTimeColumn get scheduledTime => dateTime().nullable()();
  IntColumn get priority => integer().withDefault(const Constant(0))();
  BoolColumn get isCompleted => boolean().withDefault(const Constant(false))();
  DateTimeColumn get completedAt => dateTime().nullable()();
  TextColumn get recordId => text().nullable().references(HabitRecords, #id, onDelete: KeyAction.setNull)();
  DateTimeColumn get createdAt => dateTime()();

  @override
  Set<Column> get primaryKey => {id};
}

@DataClassName('HabitFrontmatterData')
class HabitFrontmatters extends Table {
  TextColumn get id => text()();
  TextColumn get title => text()();
  TextColumn get content => text()();
  TextColumn get tags => text()(); // JSON array
  DateTimeColumn get createdAt => dateTime()();
  DateTimeColumn get updatedAt => dateTime()();
  TextColumn get metadata => text().nullable()(); // JSON object

  @override
  Set<Column> get primaryKey => {id};
}
```

#### 5.3.3 Repositoryå®ç°

```dart
// lib/features/habits/data/repositories/habit_repository_impl.dart
class HabitRepositoryImpl implements HabitRepository {
  final HabitDao _habitDao;
  final HabitRecordDao _recordDao;
  final DailyPlanDao _planDao;

  HabitRepositoryImpl({
    required HabitDao habitDao,
    required HabitRecordDao recordDao,
    required DailyPlanDao planDao,
  })  : _habitDao = habitDao,
        _recordDao = recordDao,
        _planDao = planDao;

  @override
  Future<Habit> createHabit(Habit habit) async {
    await _habitDao.insertHabit(habit.toData());
    return habit;
  }

  @override
  Stream<List<Habit>> watchActiveHabits() {
    return _habitDao.watchActiveHabits().map((list) => 
      list.map((data) => data.toEntity()).toList()
    );
  }

  @override
  Future<void> recordExecution(HabitRecord record) async {
    await _recordDao.insertRecord(record.toData());
  }

  @override
  Future<List<DailyPlan>> generateDailyPlan({
    required DateTime date,
    required List<String> habitIds,
  }) async {
    final habits = await _habitDao.getHabitsByIds(habitIds);
    final plans = <DailyPlan>[];
    
    for (var i = 0; i < habits.length; i++) {
      final habit = habits[i];
      final plan = DailyPlan(
        id: const Uuid().v4(),
        planDate: date,
        habitId: habit.id,
        cueTask: habit.cue,
        scheduledTime: null,
        priority: i,
        isCompleted: false,
        completedAt: null,
        recordId: null,
        createdAt: DateTime.now(),
      );
      
      await _planDao.insertPlan(plan.toData());
      plans.add(plan);
    }
    
    return plans;
  }

  @override
  Future<HabitStats> getHabitStats(String habitId) async {
    final records = await _recordDao.getRecordsByHabitId(habitId);
    
    // è®¡ç®—è¿ç»­å¤©æ•°
    int currentStreak = _calculateCurrentStreak(records);
    
    // è®¡ç®—æ€»æ‰§è¡Œæ¬¡æ•°
    int totalExecutions = records.length;
    
    // è®¡ç®—æœ¬å‘¨æ‰§è¡Œæ¬¡æ•°
    int thisWeekExecutions = _calculateThisWeekExecutions(records);
    
    // è®¡ç®—å®Œæˆç‡ï¼ˆå‡è®¾æ¯å¤©ä¸€æ¬¡ï¼‰
    double completionRate = _calculateCompletionRate(records);
    
    return HabitStats(
      currentStreak: currentStreak,
      totalExecutions: totalExecutions,
      thisWeekExecutions: thisWeekExecutions,
      completionRate: completionRate,
    );
  }

  int _calculateCurrentStreak(List<HabitRecordData> records) {
    if (records.isEmpty) return 0;
    
    // æŒ‰æ—¥æœŸé™åºæ’åº
    records.sort((a, b) => b.executedAt.compareTo(a.executedAt));
    
    int streak = 0;
    DateTime currentDate = DateTime.now();
    
    for (var record in records) {
      final recordDate = DateTime(
        record.executedAt.year,
        record.executedAt.month,
        record.executedAt.day,
      );
      final checkDate = DateTime(
        currentDate.year,
        currentDate.month,
        currentDate.day,
      );
      
      if (recordDate == checkDate) {
        streak++;
        currentDate = currentDate.subtract(const Duration(days: 1));
      } else {
        break;
      }
    }
    
    return streak;
  }

  int _calculateThisWeekExecutions(List<HabitRecordData> records) {
    final now = DateTime.now();
    final weekStart = now.subtract(Duration(days: now.weekday - 1));
    
    return records.where((record) =>
      record.executedAt.isAfter(weekStart)
    ).length;
  }

  double _calculateCompletionRate(List<HabitRecordData> records) {
    if (records.isEmpty) return 0.0;
    
    final firstRecord = records.reduce((a, b) =>
      a.executedAt.isBefore(b.executedAt) ? a : b
    );
    
    final daysSinceStart = DateTime.now().difference(firstRecord.executedAt).inDays + 1;
    
    return records.length / daysSinceStart;
  }
}
```

#### 5.3.4 Riverpod Providers

```dart
// lib/features/habits/presentation/providers/habit_provider.dart
final habitRepositoryProvider = Provider<HabitRepository>((ref) {
  final database = ref.watch(databaseProvider);
  return HabitRepositoryImpl(
    habitDao: database.habitDao,
    recordDao: database.habitRecordDao,
    planDao: database.dailyPlanDao,
  );
});

final activeHabitsProvider = StreamProvider<List<Habit>>((ref) {
  final repository = ref.watch(habitRepositoryProvider);
  return repository.watchActiveHabits();
});

final habitStatsProvider = FutureProvider.family<HabitStats, String>((ref, habitId) async {
  final repository = ref.watch(habitRepositoryProvider);
  return repository.getHabitStats(habitId);
});

final dailyPlanProvider = StreamProvider.family<List<DailyPlan>, DateTime>((ref, date) {
  final repository = ref.watch(habitRepositoryProvider);
  return repository.watchDailyPlans(date);
});
```

#### 5.3.5 UIç»„ä»¶ç¤ºä¾‹

```dart
// lib/features/habits/presentation/widgets/habit_card.dart
class HabitCard extends ConsumerWidget {
  final Habit habit;

  const HabitCard({super.key, required this.habit});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final statsAsync = ref.watch(habitStatsProvider(habit.id));

    return CupertinoListTile(
      title: Row(
        children: [
          Text(habit.name),
          if (habit.type == HabitType.replacement)
            Container(
              margin: const EdgeInsets.only(left: 8),
              padding: const EdgeInsets.symmetric(horizontal: 6, vertical: 2),
              decoration: BoxDecoration(
                color: CupertinoColors.systemOrange.withOpacity(0.2),
                borderRadius: BorderRadius.circular(4),
              ),
              child: const Text(
                'æ›¿ä»£',
                style: TextStyle(
                  fontSize: 10,
                  color: CupertinoColors.systemOrange,
                ),
              ),
            ),
        ],
      ),
      subtitle: Column(
        crossAxisAlignment: CrossAxisAlignment.start,
        children: [
          const SizedBox(height: 4),
          Text(
            'æš—ç¤º: ${habit.cue}',
            style: const TextStyle(
              fontSize: 12,
              color: CupertinoColors.systemGrey,
            ),
            maxLines: 1,
            overflow: TextOverflow.ellipsis,
          ),
          const SizedBox(height: 4),
          statsAsync.when(
            data: (stats) => Row(
              children: [
                const Text('ğŸ”¥'),
                const SizedBox(width: 4),
                Text(
                  '${stats.currentStreak}å¤©',
                  style: const TextStyle(
                    fontSize: 12,
                    fontWeight: FontWeight.w600,
                  ),
                ),
              ],
            ),
            loading: () => const CupertinoActivityIndicator(),
            error: (_, __) => const SizedBox(),
          ),
        ],
      ),
      trailing: CupertinoButton(
        padding: EdgeInsets.zero,
        child: const Icon(CupertinoIcons.checkmark_circle),
        onPressed: () => _showCheckInDialog(context, ref),
      ),
      onTap: () {
        // å¯¼èˆªåˆ°è¯¦æƒ…é¡µ
        context.push('/habits/${habit.id}');
      },
    );
  }

  void _showCheckInDialog(BuildContext context, WidgetRef ref) {
    showCupertinoDialog(
      context: context,
      builder: (context) => CheckInDialog(habit: habit),
    );
  }
}
```

```dart
// lib/features/habits/presentation/widgets/check_in_dialog.dart
class CheckInDialog extends ConsumerStatefulWidget {
  final Habit habit;

  const CheckInDialog({super.key, required this.habit});

  @override
  ConsumerState<CheckInDialog> createState() => _CheckInDialogState();
}

class _CheckInDialogState extends ConsumerState<CheckInDialog> {
  DateTime _executedAt = DateTime.now();
  int _quality = 3;
  final _notesController = TextEditingController();

  @override
  void dispose() {
    _notesController.dispose();
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    return CupertinoAlertDialog(
      title: const Text('ä»Šæ—¥æ‰“å¡'),
      content: Column(
        children: [
          const SizedBox(height: 16),
          
          // æ‰§è¡Œæ—¶é—´
          Row(
            mainAxisAlignment: MainAxisAlignment.spaceBetween,
            children: [
              const Text('æ‰§è¡Œæ—¶é—´'),
              CupertinoButton(
                padding: EdgeInsets.zero,
                child: Text(
                  '${_executedAt.hour}:${_executedAt.minute.toString().padLeft(2, '0')}',
                ),
                onPressed: () => _showTimePicker(context),
              ),
            ],
          ),
          
          const SizedBox(height: 16),
          
          // æ‰§è¡Œè´¨é‡
          const Text('æ‰§è¡Œè´¨é‡'),
          const SizedBox(height: 8),
          Row(
            mainAxisAlignment: MainAxisAlignment.center,
            children: List.generate(5, (index) {
              return GestureDetector(
                onTap: () => setState(() => _quality = index + 1),
                child: Padding(
                  padding: const EdgeInsets.symmetric(horizontal: 4),
                  child: Text(
                    index < _quality ? 'â­' : 'â˜†',
                    style: const TextStyle(fontSize: 24),
                  ),
                ),
              );
            }),
          ),
          
          const SizedBox(height: 16),
          
          // æ‰§è¡Œç¬”è®°
          CupertinoTextField(
            controller: _notesController,
            placeholder: 'æ‰§è¡Œç¬”è®°ï¼ˆå¯é€‰ï¼‰',
            maxLines: 3,
          ),
        ],
      ),
      actions: [
        CupertinoDialogAction(
          isDestructiveAction: true,
          onPressed: () => Navigator.pop(context),
          child: const Text('å–æ¶ˆ'),
        ),
        CupertinoDialogAction(
          onPressed: _handleCheckIn,
          child: const Text('ç¡®è®¤æ‰“å¡'),
        ),
      ],
    );
  }

  void _showTimePicker(BuildContext context) {
    showCupertinoModalPopup(
      context: context,
      builder: (context) => Container(
        height: 200,
        color: CupertinoColors.systemBackground,
        child: CupertinoDatePicker(
          mode: CupertinoDatePickerMode.time,
          initialDateTime: _executedAt,
          onDateTimeChanged: (DateTime newDateTime) {
            setState(() => _executedAt = newDateTime);
          },
        ),
      ),
    );
  }

  Future<void> _handleCheckIn() async {
    final record = HabitRecord(
      id: const Uuid().v4(),
      habitId: widget.habit.id,
      executedAt: _executedAt,
      quality: _quality,
      notes: _notesController.text.isNotEmpty ? _notesController.text : null,
      isBackfilled: false,
      createdAt: DateTime.now(),
    );

    try {
      await ref.read(habitRepositoryProvider).recordExecution(record);
      
      if (mounted) {
        Navigator.pop(context);
        
        // æ˜¾ç¤ºæˆåŠŸæç¤º
        showCupertinoDialog(
          context: context,
          builder: (context) => CupertinoAlertDialog(
            content: Column(
              children: [
                const Text('âœ“', style: TextStyle(fontSize: 48)),
                const SizedBox(height: 8),
                Text('æ‰“å¡æˆåŠŸï¼è¿ç»­${ref.read(habitStatsProvider(widget.habit.id)).value?.currentStreak ?? 0}å¤©'),
              ],
            ),
            actions: [
              CupertinoDialogAction(
                onPressed: () => Navigator.pop(context),
                child: const Text('ç¡®å®š'),
              ),
            ],
          ),
        );
      }
    } catch (e) {
      if (mounted) {
        showCupertinoDialog(
          context: context,
          builder: (context) => CupertinoAlertDialog(
            title: const Text('é”™è¯¯'),
            content: Text('æ‰“å¡å¤±è´¥: $e'),
            actions: [
              CupertinoDialogAction(
                onPressed: () => Navigator.pop(context),
                child: const Text('ç¡®å®š'),
              ),
            ],
          ),
        );
      }
    }
  }
}
```

---

## 6. å®ç°æ­¥éª¤

### é˜¶æ®µä¸€ï¼šåŸºç¡€æ¶æ„ï¼ˆ1-2å¤©ï¼‰

1. **æ•°æ®åº“å±‚**
   - åˆ›å»ºDriftè¡¨å®šä¹‰
   - å®ç°DAOå±‚
   - ç¼–å†™è¿ç§»è„šæœ¬

2. **é¢†åŸŸå±‚**
   - å®šä¹‰å®ä½“
   - åˆ›å»ºä»“åº“æ¥å£
   - å®ç°ç”¨ä¾‹

3. **æ•°æ®å±‚**
   - å®ç°æ•°æ®æº
   - å®ç°ä»“åº“

### é˜¶æ®µäºŒï¼šæ ¸å¿ƒåŠŸèƒ½ï¼ˆ3-4å¤©ï¼‰

1. **ä¹ æƒ¯ç®¡ç†**
   - åˆ›å»º/ç¼–è¾‘/åˆ é™¤ä¹ æƒ¯
   - ä¹ æƒ¯åˆ—è¡¨é¡µé¢
   - ä¹ æƒ¯è¯¦æƒ…é¡µé¢

2. **æ‰“å¡åŠŸèƒ½**
   - æ‰“å¡å¯¹è¯æ¡†
   - è®°å½•ä¿å­˜
   - ç»Ÿè®¡è®¡ç®—

3. **æ•°æ®å±•ç¤º**
   - è¿ç»­å¤©æ•°è®¡ç®—
   - æ—¥å†çƒ­åŠ›å›¾
   - ç»Ÿè®¡å›¾è¡¨

### é˜¶æ®µä¸‰ï¼šé«˜çº§åŠŸèƒ½ï¼ˆ2-3å¤©ï¼‰

1. **æ¬¡æ—¥è®¡åˆ’**
   - è®¡åˆ’ç”Ÿæˆé€»è¾‘
   - è®¡åˆ’ç®¡ç†ç•Œé¢
   - è®¡åˆ’ä¸æ‰“å¡å…³è”

2. **Frontmatter**
   - Markdownç¼–è¾‘å™¨
   - æ ‡ç­¾ç®¡ç†
   - æ—¶é—´çº¿å±•ç¤º

### é˜¶æ®µå››ï¼šä¼˜åŒ–ä¸æµ‹è¯•ï¼ˆ1-2å¤©ï¼‰

1. **æ€§èƒ½ä¼˜åŒ–**
   - æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–
   - UIæ¸²æŸ“ä¼˜åŒ–
   - å†…å­˜ç®¡ç†

2. **ç”¨æˆ·ä½“éªŒ**
   - åŠ¨ç”»æ•ˆæœ
   - äº¤äº’åé¦ˆ
   - é”™è¯¯å¤„ç†

3. **æµ‹è¯•**
   - å•å…ƒæµ‹è¯•
   - é›†æˆæµ‹è¯•
   - UIæµ‹è¯•

---

## 7. æ•°æ®ç¤ºä¾‹

### 7.1 ç¤ºä¾‹ä¹ æƒ¯æ•°æ®

```json
{
  "id": "habit-001",
  "name": "å»å›¾ä¹¦é¦†å­¦ä¹ ",
  "cue": "å‡†å¤‡å¥½ä¹¦åŒ…æ”¾åœ¨ä¸€è¿›é—¨å°±èƒ½çœ‹åˆ°çš„æ¤…å­æˆ–æ¡Œå­ä¸Š",
  "routine": "æ‹¿èµ·ä¹¦åŒ…å»å›¾ä¹¦é¦†",
  "reward": "è‡ªå¾‹çš„å®ç°è®©æˆ‘ç²¾ç¥æ»¡è¶³ï¼Œå¯¹è‡ªå·±çš„æŒæ§åŠ›",
  "type": "POSITIVE",
  "category": "å­¦ä¹ ",
  "isActive": true,
  "createdAt": "2024-01-01T08:00:00Z",
  "updatedAt": "2024-10-04T20:00:00Z"
}
```

```json
{
  "id": "habit-002",
  "name": "å¥åº·é¥®é£Ÿ",
  "cue": "å¾ˆæ— èŠï¼Œæƒ³æ‰¾åˆºæ¿€",
  "oldRoutine": "å–å¥¶èŒ¶ã€ç¢³é…¸é¥®æ–™",
  "routine": "å–ä¸€ç“¶å†°é…¸å¥¶æˆ–å†°çš„ç”µè§£è´¨é¥®æ–™",
  "reward": "äº«å—åˆºæ¿€æ„Ÿï¼ŒåŒæ—¶ä¿æŒå¥åº·",
  "type": "REPLACEMENT",
  "category": "å¥åº·",
  "isActive": true,
  "createdAt": "2024-02-01T08:00:00Z",
  "updatedAt": "2024-10-04T20:00:00Z"
}
```

### 7.2 ç¤ºä¾‹æ‰§è¡Œè®°å½•

```json
{
  "id": "record-001",
  "habitId": "habit-001",
  "executedAt": "2024-10-04T20:30:00Z",
  "quality": 5,
  "notes": "ä»Šå¤©æ•ˆç‡ç‰¹åˆ«é«˜ï¼Œå®Œæˆäº†å¾ˆå¤šä»»åŠ¡",
  "isBackfilled": false,
  "createdAt": "2024-10-04T20:35:00Z"
}
```

### 7.3 ç¤ºä¾‹æ¬¡æ—¥è®¡åˆ’

```json
{
  "id": "plan-001",
  "planDate": "2024-10-05T00:00:00Z",
  "habitId": "habit-001",
  "cueTask": "å‡†å¤‡å¥½ä¹¦åŒ…æ”¾åœ¨ä¸€è¿›é—¨å°±èƒ½çœ‹åˆ°çš„æ¤…å­æˆ–æ¡Œå­ä¸Š",
  "scheduledTime": "2024-10-05T07:00:00Z",
  "priority": 0,
  "isCompleted": false,
  "createdAt": "2024-10-04T21:00:00Z"
}
```

---

## 8. æ½œåœ¨æ‰©å±•åŠŸèƒ½

1. **ç¤¾äº¤åŠŸèƒ½**
   - ä¹ æƒ¯åˆ†äº«
   - å¥½å‹äº’ç›¸ç›‘ç£
   - ä¹ æƒ¯æ’è¡Œæ¦œ

2. **AIè¾…åŠ©**
   - ä¹ æƒ¯æ¨è
   - æš—ç¤ºä¼˜åŒ–å»ºè®®
   - å¥–èµè®¾è®¡å»ºè®®

3. **æ•°æ®åˆ†æ**
   - ä¹ æƒ¯å®Œæˆç‡è¶‹åŠ¿
   - æœ€ä½³æ‰§è¡Œæ—¶é—´åˆ†æ
   - ä¹ æƒ¯ç›¸å…³æ€§åˆ†æ

4. **æé†’ç³»ç»Ÿ**
   - æš—ç¤ºæé†’
   - æ‰“å¡æé†’
   - è®¡åˆ’æé†’

5. **å¯¼å‡ºåŠŸèƒ½**
   - å¯¼å‡ºä¹ æƒ¯æ•°æ®
   - ç”Ÿæˆä¹ æƒ¯æŠ¥å‘Š
   - åˆ†äº«ä¹ æƒ¯æˆå°±

---

## 9. æ³¨æ„äº‹é¡¹

1. **æ•°æ®éšç§**
   - æ‰€æœ‰æ•°æ®æœ¬åœ°å­˜å‚¨
   - ä¸ä¸Šä¼ åˆ°æœåŠ¡å™¨
   - æ”¯æŒæ•°æ®å¤‡ä»½

2. **ç”¨æˆ·ä½“éªŒ**
   - æ“ä½œç®€å•ç›´è§‚
   - å‡å°‘è¾“å…¥è´Ÿæ‹…
   - åŠæ—¶åé¦ˆ

3. **æ€§èƒ½è€ƒè™‘**
   - å¤§é‡æ•°æ®æ—¶çš„æŸ¥è¯¢ä¼˜åŒ–
   - UIæ¸²æŸ“æ€§èƒ½
   - å†…å­˜ä½¿ç”¨

4. **å¯ç»´æŠ¤æ€§**
   - æ¸…æ™°çš„ä»£ç ç»“æ„
   - å®Œå–„çš„æ³¨é‡Š
   - å•å…ƒæµ‹è¯•è¦†ç›–

---

## 10. æ€»ç»“

è¿™ä¸ªä¹ æƒ¯æ¨¡å—åŸºäºã€Šä¹ æƒ¯çš„åŠ›é‡ã€‹çš„ç§‘å­¦ç†è®ºï¼Œå°†å¸®åŠ©ç”¨æˆ·ï¼š

1. **å»ºç«‹å¥½ä¹ æƒ¯**ï¼šé€šè¿‡æ˜ç¡®çš„æš—ç¤º-è¡Œä¸º-å¥–èµå¾ªç¯
2. **æ”¹å˜åä¹ æƒ¯**ï¼šé€šè¿‡ä¹ æƒ¯æ›¿ä»£æœºåˆ¶
3. **æŒç»­è¿½è¸ª**ï¼šé€šè¿‡æ‰“å¡å’Œç»Ÿè®¡åŠŸèƒ½
4. **æå‰è§„åˆ’**ï¼šé€šè¿‡æ¬¡æ—¥è®¡åˆ’åŠŸèƒ½
5. **æ·±åº¦åæ€**ï¼šé€šè¿‡Frontmatterè®°å½•æ„Ÿæ‚Ÿ

æ•´ä¸ªè®¾è®¡æ³¨é‡å®ç”¨æ€§å’Œæ˜“ç”¨æ€§ï¼Œå¸®åŠ©ç”¨æˆ·çœŸæ­£å…»æˆé•¿æœŸæœ‰ç›Šçš„ä¹ æƒ¯ã€‚ä¹ æƒ¯å¾ªç¯ä¸‰è¦ç´ ï¼š**
- **æš—ç¤ºï¼ˆCueï¼‰**ï¼šè§¦å‘ä¹ æƒ¯çš„ç¯å¢ƒæˆ–æƒ…å¢ƒä¿¡å·
- **æƒ¯å¸¸è¡Œä¸ºï¼ˆRoutineï¼‰**ï¼šä¹ æƒ¯æ€§æ‰§è¡Œçš„åŠ¨ä½œ
- **å¥–èµï¼ˆRewardï¼‰**ï¼šè¡Œä¸ºå¸¦æ¥çš„æ»¡è¶³æ„Ÿæˆ–æ”¶ç›Š

**ä¹ æƒ¯æ›¿ä»£ï¼ˆHabit Replacementï¼‰**ï¼š
- ä¿æŒç›¸åŒçš„æš—ç¤ºå’Œå¥–èµ
- æ”¹å˜ä¸­é—´çš„æƒ¯å¸¸è¡Œä¸º
- ç”¨äºçº æ­£ä¸è‰¯ä¹ æƒ¯

---

## 2. åŠŸèƒ½éœ€æ±‚

### 2.1 æ ¸å¿ƒåŠŸèƒ½

#### 2.1.1 ä¹ æƒ¯ç®¡ç†

**åˆ›å»ºä¹ æƒ¯**
- è¾“å…¥ä¹ æƒ¯åç§°
- å®šä¹‰æš—ç¤ºï¼ˆè§¦å‘æ¡ä»¶ï¼‰
- å®šä¹‰æƒ¯å¸¸è¡Œä¸ºï¼ˆè¦æ‰§è¡Œçš„åŠ¨ä½œï¼‰
- å®šä¹‰å¥–èµï¼ˆç²¾ç¥æˆ–ç‰©è´¨å›æŠ¥ï¼‰
- é€‰æ‹©ä¹ æƒ¯ç±»å‹ï¼š
  - æ­£å‘ä¹ æƒ¯ï¼ˆå»ºç«‹æ–°ä¹ æƒ¯ï¼‰
  - ä¹ æƒ¯æ›¿ä»£ï¼ˆæ”¹å˜ä¸è‰¯ä¹ æƒ¯ï¼‰
- è®¾ç½®ä¹ æƒ¯æ ‡ç­¾/åˆ†ç±»
- æ·»åŠ å¤‡æ³¨è¯´æ˜

**ä¹ æƒ¯ç±»å‹è¯´æ˜ï¼š**

1. **æ­£å‘ä¹ æƒ¯ç¤ºä¾‹**ï¼š
   ```
   åç§°ï¼šå»å›¾ä¹¦é¦†å­¦ä¹ 
   æš—ç¤ºï¼šå‡†å¤‡å¥½ä¹¦åŒ…æ”¾åœ¨ä¸€è¿›é—¨å°±èƒ½çœ‹åˆ°çš„æ¤…å­æˆ–æ¡Œå­ä¸Š
   æƒ¯å¸¸è¡Œä¸ºï¼šæ‹¿èµ·ä¹¦åŒ…å»å›¾ä¹¦é¦†
   å¥–èµï¼šè‡ªå¾‹çš„å®ç°è®©æˆ‘ç²¾ç¥æ»¡è¶³ï¼Œå¯¹è‡ªå·±çš„æŒæ§åŠ›
   ç±»å‹ï¼šæ­£å‘ä¹ æƒ¯
   ```

2. **ä¹ æƒ¯æ›¿ä»£ç¤ºä¾‹**ï¼š
   ```
   åç§°ï¼šå¥åº·é¥®é£Ÿä¹ æƒ¯
   æš—ç¤ºï¼šå¾ˆæ— èŠï¼Œæƒ³æ‰¾åˆºæ¿€
   åŸæƒ¯å¸¸è¡Œä¸ºï¼šå–å¥¶èŒ¶ã€ç¢³é…¸é¥®æ–™ï¼ˆç”œçš„å’Œå†°çš„ï¼‰
   æ–°æƒ¯å¸¸è¡Œä¸ºï¼šå–ä¸€ç“¶å†°é…¸å¥¶æˆ–å†°çš„ç”µè§£è´¨é¥®æ–™
   å¥–èµï¼šåˆºæ¿€æ„Ÿã€äº«å—
   ç±»å‹ï¼šä¹ æƒ¯æ›¿ä»£
   ```

**